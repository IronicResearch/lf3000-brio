# Makefile for Mobileer MIDI Engine Examples
# (C) 2006 Mobileer, Inc.

# Use shared file to define object lists.
include ../build/MakefileVariables

CC = arm-linux-gcc

CFLAGS = \
	-DSPMIDI_PRESETS_CUSTOM=1 \
	-DSPMIDI_USE_PRINTF \
	-DSPMIDI_ME3000=0 \
	-DSPMIDI_ME2000=1 \
	-DSPMIDI_DSP_ARM946 \
	-DSPMIDI_DSP_ARM946_P1 \
	-Wall \
	-O3 \
	$(ME2000_INCLUDEPATH) \
	-I../examples \
	-I../qa 

#	-DSPMIDI_DSP_ARM946 \
#	-DSPMIDI_DSP_ARM946_P1 \
#	-DSPMIDI_DSP_ARM946_P2 \
	
#DEMO_ME2000_SONG = ../data/FurryLisa_rt.mid
#DEMO_ME3000_SONG = ../data/ZipKit.mxmf
		 
# Use simple players from examples folder.
#DEMO_ME2000_EXE = play_midifile
#DEMO_ME3000_EXE = play_song

# Link with utility files that load the MIDI data and output the audio as a WAV file.
DEMO_OBJS = \
	 spmidi_errortext.o \
	 spmidi_audio_file.o \
	 spmidi_play.o \
	 spmidi_load.o \
	 write_wav.o
	 
all: libme2000.a
	@echo "Building libme2000.a"

libme2000.a:  $(DEMO_OBJS) $(SPMIDI_OBJS)
	@echo 'Building target: $@'
	@echo 'Invoking: GCC Archiver'
	arm-linux-ar -r "libme2000.a" $(DEMO_OBJS) $(SPMIDI_OBJS)
	mv libme2000.a ../../Libs/arm
	@echo 'Finished building target: $@'
	@echo ' '


$(DEMO_ME2000_EXE): $(DEMO_OBJS) $(SPMIDI_OBJS)

$(DEMO_ME3000_EXE): $(DEMO_OBJS) $(SPMIDI_OBJS)

# Run the demo that converts a MIDI file to a WAV file.
me2000.wav: $(DEMO_ME2000_EXE)
	./$(DEMO_ME2000_EXE) $(DEMO_ME2000_SONG)
	mv spmidi_output.wav me2000.wav
	@echo "ME2000 Output written to me2000.wav file."

# Run the demo that converts a MIDI or MXMF file to a WAV file.
me3000.wav: $(DEMO_ME3000_EXE)
	./$(DEMO_ME3000_EXE) $(DEMO_ME3000_SONG)
	mv spmidi_output.wav me3000.wav
	@echo "ME3000 Output written to me3000.wav file."
	
clean:
	@rm *.o
#	@rm $(DEMO_ME2000_EXE)
#	@rm $(DEMO_ME3000_EXE)
	@rm *.wav
	
	

